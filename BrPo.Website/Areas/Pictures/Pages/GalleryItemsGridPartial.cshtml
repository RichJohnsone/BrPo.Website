@using BrPo.Website.Services.Image.Models;
@using BrPo.Website.Services.Image.Services
@using BrPo.Website.Areas.Pictures.Pages
@using System.Text
@inject IImageService ImageService;

@model IList<ImageGalleryItem>

@(Html
    .Grid(Model)
    .Build(columns =>
    {          
        columns.Add(model => model.ImageFile)
            .Titled("Image")
            .Encoded(false)
            .RenderedAs(model =>
            {
                var base64 = ImageService.GetBase64ThumbnailAsync(model.ImageFile.Id, 100).Result;
                return HtmlHelpers.GetGalleryItemImageTag(base64, model.Name);
            });
        columns.Add(model => model.Name)
            .Titled("Name")
            .Sortable(true)
            .Encoded(false)
            .Filterable(true)
            .RenderedAs(model =>
            {
                return HtmlHelpers.GetGalleryItemNameTags(model);
            });
        columns.Add(model => model.Description)
            .Titled("Description")
            .Encoded(false)
            .RenderedAs(model =>
            {
                return HtmlHelpers.GetDescription(model.Description);
            })
            .Css("d-none d-md-table-cell");
        columns.Add(model => model.ImageFile.ImageCreatedDate)
            .Titled("Created")
            .Formatted("{0:d}")
            .Css("d-none d-lg-table-cell");
        columns.Add().Titled("Gallery Item")
            .Encoded(false)
            .Css("d-none d-sm-table-cell")
            .RenderedAs(model =>
            {
                return HtmlHelpers.GetIsGalleryItemActiveTag(model);
            });
        columns.Add(model => model.Id)
            .Titled("")
            .Encoded(false)
            .RenderedAs(model =>
            {
                return HtmlHelpers.GetGalleryItemButtons(model.Id, model.ImageFileId);

            })
            .Css("actions-column");
    })
    .UsingUrl("MyImages?handler=Grid")
    .Empty("No images found")
    .Pageable(pager =>
    {
        pager.PagesToDisplay = 5;
        pager.RowsPerPage = 5;
    })
    .Css("table")
    .Attributed(new { data_type = "image-files" })
    .Id("gallery-items-grid")
)